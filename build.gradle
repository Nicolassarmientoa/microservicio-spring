plugins {
    id 'org.sonarqube' version '3.5.0.2730'
	id 'org.springframework.boot' version '2.6.3'
	id 'io.spring.dependency-management' version '1.0.11.RELEASE'
	id 'java'
	id 'jacoco'
}

sonarqube {
    properties {
        property 'sonar.projectKey', 'myorg:myproject'
        property 'sonar.organization', 'myorg'
        property 'sonar.sources', 'src/main'
        property 'sonar.exclusions', '**/*.spec.ts, **/*.test.ts, **/node_modules/**, **/vendor/**, **/dist/**, **/build/**'
    }
}

group = 'com.example'
@@ -17,6 +18,31 @@ dependencies {
	testImplementation('org.springframework.boot:spring-boot-starter-test')
}

jacoco {
    toolVersion = "0.8.7"
    reportsDir = file("$buildDir/reports/jacoco")
}

jacocoTestCoverageVerification {
  violationRules {
    rule {
      limit {
        minimum = 0.7
      }
    }
  }
}

jacocoTestReport {
  reports {
    xml.enabled = true
    html.enabled = true
  }
}

test.finalizedBy jacocoTestReport
check.dependsOn jacocoTestCoverageVerification

test {
	useJUnitPlatform()
  useJUnitPlatform()
}


